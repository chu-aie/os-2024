# 스케줄링: 멀티 레벨 피드백 큐[^Jo-Sehyun]

[^Jo-Sehyun]: [조세현](https://github.com/Jo-Sehyun)

멀티 레벨 피드백 큐 (MLFQ) 스케줄러는 Compatible Time-Sharing System(CTSS)에 사용되며 Corbato 등에 의해 1962년에 최초로 소개되었ᨩ습니다. 이 연구와 Multics에 대한 후속 연구로 Corbato는 최고 영예인 Turing Award를 안았습니다. 이 스케줄러는 수년 동안 다듬어져 일부 현대 시스템에까지 발전되었습니다.

MLFQ가 해결하려고 하는 기본적인 문제는 두 가지입니다. 
1. 짧은 작업을 먼저 실행시켜 반환 시간을 최적화하고자 합니다. SJF나 STCF 같은 알고리즘은 작업ᨦ의 실행 시간 정보를 필요로 하지만, 불행히도 운영체제는 이 실행 시간을 미리 알 수 없습니다.
2. MLFQ는 대화형 사용자 (화면 앞에 앉아 바라보면서 프로세스의 종료를 기다리는 사용자)에게 응답이 빠른 시스템이라는 느낌을 주고 싶었기 때문에 응답 시간을 최적화합니다. 불행히도 RR과 같은 알고리즘은 응답 시간을 단축시키지만 반환 시간은 거의 최악에 가깝습니다.

우리의 문제는 다음과 같습니다. 
- 우리가 프로세스에 대한 정보가 없다면 이러한 스케줄러를 어떻게 만들 수 있을까? 
- 실행 중인 작업의 특성을 알아내고 이를 이용하여 더 나은 스케줄링 결정을 하기 위한 방법은 무엇인가?

```{admonition} 핵심 질문: 정보 없이 스케줄 하는 방법은 무엇인가?
작업의 실행 시간에 대한 선행 정보 없이 대화형 작업의 응답 시간을 최소화하고 동시에 반환 시시간을 최소화하는 스케줄러를 어떻게 설계할 수 있는가?
```

## MLFQ: 기본 규칙

멀티 레벨 피드백 큐의 기본 알고리즘을 설명합니다. 현재 구현되어 있는 여러 MLFQ들은 자세하하게 살펴보면 차이가 있지만, 기본적으로 비슷한 방법을 사용하고 있습니다. 
MLFQ는 여러 개의 큐로 구성되며, 각각 다른 우선순위(priority level)가 배정됩니다. 실행 준비가 된 프로세스는 이 중 하나의 큐에 존재합니다. MLFQ는 실행할 프로세스를 결정하기 위하여 우선순위를 사용합니다. 높은 우선순위를 가진 작업이, 즉 높은 우선순위 큐에 존재하는 작업이 선택됩니다.

```{admonition} 팁: 역사로부터 배우다
멀티 레벨 피드백 큐는 미래를 예측하기 위해 과거의 경험을 활용하는 훌륭한 예입니다. 이러한 접근 방식은 운영체제 (하드웨어 분기 예측기와 캐시 알고리즘을 포함한 컴퓨터 과학의 다른 많은 분야에서도) 분야에서 흔히 사용됩니다. 이러한 방식은 작ᨦ업이 단계별로 진행되어 예측 가능할 때 잘 동작합니다. 물론, 신중하게 사용해야 합니다. 잘못 동작하기 쉬우며, 이러한 정보가 없을 때 보다 더 나쁜 결정을 하게 만들 수 있기 때문입니다.
```

큐에 둘 이상의 작업이 존재할 수 있습니다. 이들은 모두 같은 우선순위를 가집니다. 이 작업들 사이에서는 라운드 로빈 (Round-Robin, RR) 스케줄링 알고리즘이 사용됩니다. 
MLFQ 스케줄링의 핵심은 우선순위를 정하는 방식입니다. MLFQ는 각 작업ᨦ에 고정된 우선순위를 부여하는 것이 아니라 각 작업ᨦ의 특성에 따라 동적으로 우선순위를 부여합니다. 예를 들어, 어떤 작업이 키보드 입력을 기다리며 반복적으로 CPU를 양보하면 MLFQ는 해당 작업의 우선순위를 높게 유지합니다. 이러한 패턴은 대화형 프로세스가 나타내는 패턴입니다. 대신에 한 작업이 긴 시간 동안 CPU를 집중적으로 사용하면 MLFQ는 해당 작업의 우선순위를 낮춥니다. 이렇게 MLFQ는 작업이 진행되는 동안 해당 작업의 정보를 얻고, 이 정보를 이용하여 미래 행동을 예측합니다. 
MLFQ의 두 가지 기본 규칙은 다음과 같습니다.
- 규칙 1: Priority(A) > Priority(B) 이면, B는 실행되지 않고 A가 실행됩니다.
- 규칙 2: Priority(A) = Priority(B) 이면, A와 B는 RR 방식으로 실행됩니다. 

## 시도 1: 우선순위의 변경

## 시도 2: 우선순위의 상향 조정

## 시도 3: 더 나은 시간 측정

## MLFQ 조정과 다른 쟁점들

## MLFQ: 요약
